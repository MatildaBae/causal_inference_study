# -*- coding: utf-8 -*-
"""uplift_practice.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1hLk1-gdSwgOLwXFK-jUQnLsoFI4PA8F9
"""

from google.colab import drive
drive.mount('/content/drive')

"""### Intro

#### 1. Look-alike 모델
- 기존의 고객 데이터 바탕으로, 비슷한 특성을 가진 새로운 고객을 찾아내는 방법
- 비슷한 행동을 할 가능성이 있는 사람을 목표로 마케팅 진행

#### 2. Response 모델
- 마케팅을 받은 후 고객이 어떤 행동을 했는지 분석

#### 3. Uplift 모델
- Response 모델보다 더 정교
- 마케팅이 효과를 낸 순수한 영향을 측정
## 근데 이거 상관관계랑 헷갈리지 말라고 했던 거 아닌가? 순수한 영향이라 괜찮나?

#### 4가지 고객 그룹
- Will take action: 마케팅 여부와 상관없이 제품을 구매할 고객.
- Persuadable: 마케팅을 받은 후에만 제품을 구매하는 고객.
- Do not disturb: 원래는 제품을 구매할 고객인데, 마케팅 때문에 오히려 행동을 멈추는 고객.
- Never will respond: 마케팅에 전혀 반응하지 않는 고객.

#### CATE(Conditonal Average Treatment Effect)
- 특정 그룹의 고객들에게 마케팅이 얼마나 영향을 미치는지 평균적으로 계산한 값

#### Uplift 모델의 두 가지 종류
- Meta-Learners: 일반적인 머신러닝 모델을 변형해 Uplift 효과를 예측.
- Direct Uplift Models: Uplift 효과를 직접적으로 예측하는 알고리즘.
"""

import numpy as np
import pandas as pd
from matplotlib import pyplot as plt
from tqdm.notebook import tqdm
import seaborn as sns
from statsmodels.graphics.gofplots import qqplot
!pip install scikit-uplift -q
from sklift.metrics import uplift_at_k, uplift_auc_score, qini_auc_score, weighted_average_uplift
# from sklift.viz import plot_uplift_preds
from sklift.models import SoloModel, TwoModels
import xgboost as xgb

from sklift.viz import plot_uplift_preds

train = pd.read_csv('/content/drive/MyDrive/인과추론/MegafonUplift/train (1).csv')

train.head()

train.info()

train.describe()

rows, cols = 10, 5
f, axs = plt.subplots(nrows=rows, ncols=cols, figsize=(20, 25))
f.set_facecolor("#fff")
n_feat = 1
for row in tqdm(range(rows)):
    for col in range(cols):
        try:
            sns.kdeplot(x=f'X_{n_feat}', fill=True, alpha=1, linewidth=3,
                        edgecolor="#264653", data=train, ax=axs[row, col], color='w')
            axs[row, col].patch.set_facecolor("#619b8a")
            axs[row, col].patch.set_alpha(0.8)
            axs[row, col].grid(color="#264653", alpha=1, axis="both")
        except IndexError: # hide last empty graphs
            axs[row, col].set_visible(False)
        n_feat += 1

f.show()

rows, cols = 10, 5
f, axs = plt.subplots(nrows=rows, ncols=cols, figsize=(20, 25))
f.set_facecolor("#fff")
n_feat = 1
for row in tqdm(range(rows)):
    for col in range(cols):
        try:
#             sns.kdeplot(x=f'X_{n_feat}', fill=True, alpha=1, linewidth=3,
#                         edgecolor="#264653", data=train, ax=axs[row, col], color='w')
            qqplot(train[f'X_{n_feat}'], ax=axs[row, col], line='q')
            axs[row, col].grid(color="#264653", alpha=1, axis="both")
        except IndexError: # hide last empty graphs
            axs[row, col].set_visible(False)
        n_feat += 1

f.show()

"""### Metrics
#### Uplift@k
- 상위 k%의 고객들을 대상으로 하는 uplift 효과를 측정하는 지표
- 고객들을 예상 uplift 값에 따라 내림차순으로 정렬한 후, 상위 k%에 해당하는 고객들 중 처리 그룹과 통제 그룹에서 각각의 행동(ex. 구매여부)에 대한 평균값 계산
- 그 평균값의 차이가 Uplift@k

#### 퍼센타일 및 가중 평균
- 고객을 퍼센타일(10% 구간)로 나누고, 각 퍼센타일에서 처리 그룹과 통제 그룹의 행동 차이 계산
- 가중 평균 uplift는 각 퍼센타일의 uplift값에 해당 퍼센타일 그룹의 크기를 곱해준 후, 전체 퍼센타일을 더한 값을 계산

#### Uplift Curve와 AUUC
- 각 그룹간 행동 차이를 누적해서 보여주는 곡선
- 아래 면적이 AUUC

#### Qini Curve와 AUQC
- 위와 유사
"""

train.columns

train['treatment_group'].unique()

train['treatment_group'] = train['treatment_group'].apply(lambda x: 1 if x=='treatment' else 0)

from sklearn.model_selection import train_test_split

train = train[:100000]
X = train[[f'X_{i}' for i in range(1, 51)]]
treatment = train['treatment_group']
y = train['conversion']
X_train, X_val, y_train, y_val, treatment_train, treatment_val = train_test_split(X, y, treatment, test_size=0.2)

"""### Meta-Learners

#### S-learner
- 처리 여부 변수를 하나의 입력변수로 추가해, 개입이 있는 경우와 없는 경우의 예측값 차이를 통해 업리프트 효과 추정

##### 작동 방식
1. 모델 훈련: 입력 데이터에 고객의 특성(X)와 개입 여부(W)를 입력으로 넣어, 고객의 행동을 예측하는 모델을 훈련
2. 두 가지 예측: 훈련된 모델을 사용해 동일한 고객에 대해 W=1와 W=0인 경우를 각각 예측
3. Uplift 계산: 두 예측값의 차이를 계산하여 개입이 해당 고객에게 미친 영향을 추정
"""

# S-learner
def get_metrics(y_val, uplift, treatment_val):
    #Metrics

    #uplift at top 30%. Strategy by group means sorting control and treatment separately. Overall - together
    upliftk = uplift_at_k(y_true=y_val, uplift=uplift, treatment=treatment_val, strategy='by_group', k=0.3)
    upliftk_all = uplift_at_k(y_true=y_val, uplift=uplift, treatment=treatment_val, strategy='overall', k=0.3)

    qini_coef = qini_auc_score(y_true=y_val, uplift=uplift,
                              treatment=treatment_val)

    #Default strategy - Overall
    # Area Under Uplift Curve
    uplift_auc = uplift_auc_score(y_true=y_val, uplift=uplift,
                                  treatment=treatment_val)
    # Weighted average uplift
    wau = weighted_average_uplift(y_true=y_val, uplift=uplift,
                                  treatment=treatment_val, strategy='by_group')
    wau_all = weighted_average_uplift(y_true=y_val, uplift=uplift,
                                  treatment=treatment_val)

    print(f'uplift at top 30% by group: {upliftk:.2f} by overall: {upliftk_all:.2f}\n',
          f'Weighted average uplift by group: {wau:.2f} by overall: {wau_all:.2f}\n',
          f'AUUC by group: {uplift_auc:.2f}\n',
          f'AUQC by group: {qini_coef:.2f}\n')
    return {'uplift@30': upliftk, 'uplift@30_all': upliftk_all, 'AUQC': qini_coef, 'AUUC': uplift_auc,
            'WAU': wau, 'WAU_all': wau_all}

"""1. by_group 전략
- 처리 그룹과 통제 그룹을 따로 평가
- 처리 그룹에서는 마케팅을 받은 고객들 중에서 마케팅 덕분에 행동을 바꾼 사람들 찾아냄
- 통제 그룹에서는 마케팅을 받지 않았더라도 행동을 바꿀 가능성이 있던 사람들 평가

2. overall 전략
- 처리 그룹과 통제 그룹을 함께 평가
- 마케팅을 받은 사람과 받지 않은 사람을 구분하지 않고, 모든 고객의 행동 변화만을 평가
- 마케팅이 전반적으로 어떤 효과를 미쳤는지 확인
"""

xgb_sm = xgb.XGBClassifier(random_state=42, objective='binary:logistic', use_label_encoder=False)
sm = SoloModel(estimator=xgb_sm)
sm = sm.fit(X_train, y_train, treatment_train, estimator_fit_params={})

uplift_sm = sm.predict(X_val)
res = get_metrics(y_val, uplift_sm, treatment_val)

"""##### 결과 해석
- 상위 30%에서 마케팅을 받은 그룹과 받지 않은 그룹 간의 행동 차이가 평균적으로 19% 정도 발생

#### T-learner
- 두 개의 모델을 훈련
- 마케팅을 받은 고객들의 행동을 예측하는 모델과 마케팅을 받지 않은 고객들의 행동을 예측하는 모델
- 그 예측 값의 차이를 Uplift 값으로 계산
"""

# T-Learner
xgb_T = xgb.XGBClassifier(random_state=42, objective='binary:logistic', use_label_encoder=False)
xgb_C = xgb.XGBClassifier(random_state=42, objective='binary:logistic', use_label_encoder=False)
sm = TwoModels(estimator_trmnt=xgb_T, estimator_ctrl=xgb_C)
sm = sm.fit(X_train, y_train, treatment_train, estimator_trmnt_fit_params={}, estimator_ctrl_fit_params={})

uplift_sm = sm.predict(X_val)
res = get_metrics(y_val, uplift_sm, treatment_val)

"""#### 첫번째 접근법

![image.png](data:image/png;base64,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TP7yl78MX//61+O5Pe+Py5cvX+T47++ZtoxrRe1785vfPHz/+9/3ySae8w6HHXZYXA3Iqr/f/va3E9MspQe6blPDigkUTvzwze9+97v4ndq9SUd459///nf8vic96+83advHPe5xgTqzytd4Gd42k6jx/p/+9KfwsY99zBcbWLSA1uuvf/1rrDfpIUvDYhXOzzrrrEXp4L2DDjooThKOOuqo8JznPCeWv+ihgh9N0hZkObOXxdP9N10f/Dh3gtk97nGPwtVQv//97ytxwa1udavw0Ic+NJol8B1qSi960YuiMzhmrde//vXhSU96UmBg55xVXnSYonYReOQjH1nIB1VLwsH74x//eAyDwADtiRV3RYIRPAiVDdAf+tCHwic+8Qmf5cRzfJy22267sHr16pHJbGKiJfRA121qUD32sY+NGkl+n3HGGYXCuT3vjwg4rNbkmEJ123bLLbcMBxxwQKWi6H+yghnClWl3izL5+c9/PiaY8SwLHliJysKIFQumXoRZBMIq1CRtlfxn5Rnx9DBaatr8uNZCrJ1qX8ow8Glci2td61rR8RpN2a677hq23nrrmCfxolgpN4mYQRICgVkinesOO+xQ24mXslAfW0iFF77whWHZQogFtB1GdGpf/epX7WfhEWHxN7/5TYyNVPiQbowQwFSI2Rh+IHQF2HMOoVk48cQTw69+9asoPDGY0N5oHYhLhZnSa70Q0FhhmXXiHxWWOTnvvPPiyks0bnvttVfmbr2f1AmVO1o2VlQh9M0bTaNN4YH3ve99gbLQfu24445Ra9Yl1k3aFg38fe9737hiFAGLgZ74ap4++9nPhosuuij+0Q96Ii1pmIga8T3QJ7HKFH5jtTF/ecR3w0Th9re/fXjLW94Szb55z+Vda5I2L79ZvCaeHk6rTZMf504w88188MEHx46Va3S2RxxxhL+de/7Wt741bLPNNvHen//855ieY116xzveEQUEBlK0ZOR/5zvfOWaHpuzhD3/4RBOAvQfmtZ122ilpBl+33ksp3XWuc53oD2arGPH7wvRSRviJvfKVr4wDDs8hnCFk2aq7orQMiqeffnq8zYBFezclzPCs+ENoPOSQQ8K5557bNMuZT99Vm97xjneMWiAAIkbZnnvu2SlWbbctgW/f9a53jeqMaRJTp/m+jW64E4QD+Avi23jTm94UvvOd77gnyk9Z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)

- 통제 모델의 예측을 처리 모델의 입력값으로 사용하는 방식
"""

# T-learner dependent model
# First approach
xgb_T = xgb.XGBClassifier(random_state=42, objective='binary:logistic', use_label_encoder=False)
xgb_C = xgb.XGBClassifier(random_state=42, objective='binary:logistic', use_label_encoder=False)
sm = TwoModels(estimator_trmnt=xgb_T, estimator_ctrl=xgb_C, method='ddr_control')
sm = sm.fit(X_train, y_train, treatment_train, estimator_trmnt_fit_params={}, estimator_ctrl_fit_params={})

uplift_sm = sm.predict(X_val)
res = get_metrics(y_val, uplift_sm, treatment_val)

"""#### 두번째 접근법

![image.png](data:image/png;base64,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Ct6zKMc5j079EpMMhD+EKhyZRcNDoE/8CPpMgNlqBROhnNHz+bFvbZrSz6SkNfRaC5tgGdY9su3EELaewKFRTo11W1/PpyKAjwFaH6LDYyZnYtI1Iho7Jj62mZIjetdap93y9IEffY3rhgvxaefKeV/aNKWfSUnr+WDqGipfGJ0LASFQHwFiTOFLRcDcLm6CjVkf7dmiRYvqV04peodA1/mxd4B2oMB9aNOUfiYlrW+eqTul+8LoXAgIASEgBISAEBACfUSgU2ET+gigyiwEhIAQEAJCQAgIAQlU4gEhIASEgBAQAkJACCQiIIEqEUAlFwJCQAgIASEgBISABCrxgBAQAkJACAgBISAEEhGQQJUIoJILASEgBISAEBACQkAClXhACAgBISAEhIAQEAKJCEigSgRQyYWAEBACQkAICAEhIIFKPCAEhIAQEAJCQAgIgUQEJFAlAqjkQkAICAEhIASEgBCQQCUeEAJCQAgIASEgBIRAIgISqBIBVHIhIASEgBAQAkJACEigEg8IASEgBISAEBACQiARAQlUiQAquRAQAkJACAgBISAEJFCJB4SAEBACQkAICAEhkIiABKpEAJVcCAgBISAEhIAQEAISqMQDQkAICAEhIASEgBBIREACVSKASi4EhIAQEAJCQAgIAQlU4gEhIASEgBAQAkJACCQiIIEqEUAlFwJCQAgIASEgBISABCrxgBAQAkJACAgBISAEEhGQQJUIoJILASEgBISAEBACQkAClXhACAgBISAEhIAQEAKJCEigSgRQyYWAEBACQkAICAEhIIFKPCAEhIAQEAJCQAgIgUQE/g9ApP5K1J71pgAAAABJRU5ErkJggg==)

- 처리 모델의 예측을 통제 모델의 입력으로 사용하는 방식
"""

# T-learner dependent model
# Second approach
xgb_T = xgb.XGBClassifier(random_state=42, objective='binary:logistic', use_label_encoder=False)
xgb_C = xgb.XGBClassifier(random_state=42, objective='binary:logistic', use_label_encoder=False)
sm = TwoModels(estimator_trmnt=xgb_T, estimator_ctrl=xgb_C, method='ddr_treatment')
sm = sm.fit(X_train, y_train, treatment_train, estimator_trmnt_fit_params={}, estimator_ctrl_fit_params={})

uplift_sm = sm.predict(X_val)
res = get_metrics(y_val, uplift_sm, treatment_val)
